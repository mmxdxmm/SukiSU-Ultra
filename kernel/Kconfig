menu "KernelSU"

config KSU
	tristate "KernelSU function support"
	default y
	help
	  Enable kernel-level root privileges on Android System.
	  To compile as a module, choose M here: the
	  module will be called kernelsu.

config KSU_THRONE_TRACKER_LEGACY
	bool "Use legacy throne tracker (packages.list scanning)"
	depends on KSU
	default n
	help
	  Use legacy throne tracker that scans packages.list for app UIDs.
	  This is kept for Ultra-Legacy Linux 3.X kernels which are prone to deadlocks.
	  Enable this if default scanning deadlocks/crashes on you.

config KSU_DEBUG
	bool "KernelSU debug mode"
	depends on KSU
	default n
	help
	  Enable KernelSU debug mode.

config KSU_ALLOWLIST_WORKAROUND
	bool "KernelSU Session init keyring workaround"
	depends on KSU
	default n
	help
	  Enable session keyring init workaround for problematic devices.
	  Useful for situations where the SU allowlist is not kept after a reboot.

config KSU_CMDLINE
	bool "Enable KernelSU cmdline"
	depends on KSU && KSU != m
	default n
	help
	  Enable a cmdline called kernelsu.enabled
	  Value 1 means enabled, value 0 means disabled.

config KPM
	bool "Enable SukiSU KPM"
	depends on KSU && 64BIT
	default n
	help
	  Enabling this option will activate the KPM feature of SukiSU.
	  This option is suitable for scenarios where you need to force KPM to be enabled.
	  but it may affect system stability.
	select KALLSYMS
	select KALLSYMS_ALL

config KSU_LSM_SECURITY_HOOKS
	bool "use lsm security hooks"
        depends on KSU
        default y
	help
	  Disabling this is mostly only useful for kernel 4.1 and older.
	  Make sure to implement manual hooks on security/security.c.

choice
	prompt "KernelSU hook type"
	depends on KSU
	default KSU_KPROBES_HOOK
	help
	  Hook type for KernelSU
  
config KSU_KPROBES_HOOK
	bool "Hook KernelSU with Kprobes"
	depends on KPROBES
	help
	  If enabled, Hook required KernelSU syscalls with Kernel-probe.
  
config KSU_TRACEPOINT_HOOK
	bool "Hook KernelSU with Tracepoint"
	depends on TRACEPOINTS
	help
	  If enabled, Hook required KernelSU syscalls with Tracepoint.
  
  config KSU_MANUAL_HOOK
	bool "Hook KernelSU manually"
	depends on KSU != m
	help
	  If enabled, Hook required KernelSU syscalls with manually-patched function.

endchoice

endmenu
